<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Medical Chatbot - AI Health Assistant</title>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
		<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css')}}"/>
	</head>
	
	
	<body>
		<div class="chat-container">
			<div class="chat-wrapper">
				<div class="chat-card">
					<div class="chat-header">
						<div class="bot-info">
							<div class="bot-avatar">
								<img src="https://cdn-icons-png.flaticon.com/512/387/387569.png" alt="Medical Bot" class="avatar-img">
								<span class="status-indicator online"></span>
							</div>
							<div class="bot-details">
								<h3>Medical AI Assistant</h3>
								<p>Always here to help with your health questions</p>
							</div>
						</div>
						<div class="header-actions">
							<button class="action-btn" title="Clear Chat">
								<i class="fas fa-broom"></i>
							</button>
							<button class="action-btn" title="Settings">
								<i class="fas fa-cog"></i>
							</button>
						</div>
					</div>
					
					<div id="messageFormeight" class="chat-messages">
						<div class="welcome-message">
							<div class="bot-avatar-small">
								<img src="https://cdn-icons-png.flaticon.com/512/387/387569.png" alt="Bot">
							</div>
							<div class="welcome-text">
								Hello! I'm your medical AI assistant. How can I help you today?
							</div>
						</div>
					</div>
					
					<div class="chat-input-container">
						<form id="messageArea" class="message-form">
							<div class="input-wrapper">
								<input type="text" id="text" name="msg" placeholder="Ask me about your health concerns..." autocomplete="off" class="message-input" required/>
								<button type="button" class="voice-btn" title="Voice Input">
									<i class="fas fa-microphone"></i>
								</button>
								<button type="submit" id="send" class="send-btn" title="Send Message">
									<i class="fas fa-paper-plane"></i>
								</button>
							</div>
						</form>
						<div class="typing-indicator" id="typingIndicator">
							<span></span>
							<span></span>
							<span></span>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script>
			$(document).ready(function() {
				// Clear chat functionality
				$('.action-btn').first().click(function() {
					$('#messageFormeight').html('<div class="welcome-message"><div class="bot-avatar-small"><img src="https://cdn-icons-png.flaticon.com/512/387/387569.png" alt="Bot"></div><div class="welcome-text">Hello! I\'m your medical AI assistant. How can I help you today?</div></div>');
				});

				$("#messageArea").on("submit", function(event) {
					const date = new Date();
					const hour = date.getHours().toString().padStart(2, '0');
					const minute = date.getMinutes().toString().padStart(2, '0');
					const str_time = hour + ":" + minute;
					var rawText = $("#text").val();

					// Show typing indicator
					$("#typingIndicator").show();
					
					// Remove welcome message if it exists
					$('.welcome-message').remove();

					var userHtml = '<div class="message user-message"><div class="message-content">' + rawText + '<span class="message-time">' + str_time + '</span></div><div class="user-avatar"><img src="https://i.ibb.co/d5b84Xw/Untitled-design.png" alt="User"></div></div>';
					
					$("#text").val("");
					$("#messageFormeight").append(userHtml);
					$("#messageFormeight").scrollTop($("#messageFormeight")[0].scrollHeight);

					$.ajax({
						data: {
							msg: rawText,	
						},
						type: "POST",
						url: "/get",
					}).done(function(data) {
						$("#typingIndicator").hide();
						var botHtml = '<div class="message bot-message"><div class="bot-avatar-small"><img src="https://cdn-icons-png.flaticon.com/512/387/387569.png" alt="Bot"></div><div class="message-content">' + data + '<span class="message-time">' + str_time + '</span></div></div>';
						$("#messageFormeight").append($.parseHTML(botHtml));
						$("#messageFormeight").scrollTop($("#messageFormeight")[0].scrollHeight);
					}).fail(function() {
						$("#typingIndicator").hide();
					});
					event.preventDefault();
				});
			});
		</script>
        
    </body>
</html>